## make和new

make面对切片，chan，map类型，new面对基本数据类型

new本质上是分配空间，返回的是该空间的指针，new分配的空间会被清0

make返回的是引用，因为chan，map，切片这些类型本身在golang中使用的时候用的就是他们的指针，所以，不用返回指针

make分配内存后还会进行一步初始化，因为map，切片和chan都使用了必须初始化的数据结构

## GC

golang中的gc使用的是三色标记法

1.初始标记
  - stop the world
  - 找到所有gc roots(栈中引用变量，静态变量，常量等，通过扫描堆栈和全局变量得到)
  - 启动写屏障用于并发标记阶段
  - 找到所有gc roots 放入一个标记队列

2.并发标记
  - 启动每个processer启动一个协程进行并发标记(processer就是GMP模型里哪个P)
  - 从队列中取出的对象向下搜索并标记为黑色
  - 如果过程中用户线程修改了代码则触发写屏障，golang中用的写屏障是增量更新，将新标记的灰色节点也放入队列

3.重新标记
  - stop the world
  - 重新标记队列中的全部灰色节点

4.并发清除

gc触发条件：
  - 内存：内存大小阈值， 内存达到上次gc后的2倍
  - 定时：达到定时时间 ，2m interval
